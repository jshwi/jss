{# macros.html #}

{# link to the profile page of posting author #}
{% macro profile(author) %}
    {{ url_for("views.profile", username=author.username) }}
{% endmacro %}

{# link to avatar of the posting author #}
{% macro avatar(user, size=70) %}
    <img src="{{ user.avatar(size) }}" alt="{{ user.username }}"/>
{% endmacro %}

{# timestamp set client side with formatting #}
{% macro timestamp(datetime) %}
    {{ moment(datetime).format("h:mmA DD/MM/YYYY") }}
{% endmacro %}

{# tasks progress bar #}
{% macro task_progress() %}
    {% if current_user.is_authenticated %}
        {% with tasks = current_user.get_tasks_in_progress() %}
            {% if tasks %}
                {% for task in tasks %}
                    <div class="alert alert-success" role="alert">
                        {{ task.description }}

                        {# as percentage #}
                        <span id="{{ task.id }}-progress">{{ task.get_progress() }}</span>%
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    {% endif %}
{% endmacro %}

{# flashed messages #}
{% macro flash_messages() %}
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-info" role="alert">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
{% endmacro %}
